>> Hello. In this video, I'm going to go through some advanced features of the procedural content generation starter project. This will help with completing your homework assignment. So I'll start by showing you this example scene. This doesn't quite meet the requirements of the assignment, but it does demonstrate some of the advanced features. So I already spent some time on designing this one. You can see there's clearly mountains and then outside of the mountains there are these tilly areas with what look like maybe meteor strikes or some other type of holes in the ground. And there's a few little spots with stones sticking up out of the ground. So these features were all made simply by putting constraints on Perlin noise. And so there is a hierarchy and I've got a number of different nodes here that you can see. So I'm going to go through some examples of how to do this. So what I'm doing is I'm switching to a different config serializable object. Then I'm going to click load. And so this particular one you can see is just the original terrain data. If you want to make new ones, you can do control D or select from the file menu, it's command D on a Mac. You can see I can duplicate these things. And then if I want to switch, I can drag into the config serializable object field, and then click load, and it will do what's necessary to load that particular data. So this is helpful. If you want to work with different versions, you can switch between them. You want to make sure you remember to hit the load to get it to be up-to-date. And that's because every node has a reference to the config serializable object. So if you swap the root, then you'll actually have a situation where the first node will be pointing to the new file and all the others will be pointing to an old one. Not to mention that those nodes don't exist most likely in your other safe file. So you want to make sure you always immediately hit load after you change where it's pointing and then it'll synchronize everything. So to the starting point of the assignment, you might have seen some slightly different settings in the config from at least what you get from the GitHub. So just like this, max value is price set to zero. You can see I can move this currently and probably the noise type might be on purlin, so I've switched it to none. And what I'm going to do is I'm going to move this up a bit. And the reason I'm doing this is I don't want the value base level terrain height to be pegged at the lowest level because then I won't be able to subtract anything away from the terrain. So I want to bring it up a little bit so I have some room to work if I want to carve away from terrain rather than only being additive. The downside is I lose some ability to add. So that's first thing, I have a genotype of none, that means the terrain is strictly defined by the max value. And the other settings really don't matter at this point. So you can see I've just got a flat plane. Next thing I want to do is I want to generate some noise that will serve as control for the different regions that I'm going to make. So I'm going to make a new node. We'll call these regions biomes, even though this isn't the way I'm going to show you an example. It's not really properly a biome, at least like the way you see it in, say, Minecraft. So I've declared this biomes and I've got it set to Perlin noise, and I want some really low frequency noise. Now for the purpose of demonstration so we can see everything in the same tile, I'm going to make it a little higher. So if you're making two biomes where you have to say if your character exist in this world, would have to walk away before they transition, say from desert to mountain or that sort of thing. You'd probably have an extremely low scalar value, but I'm going to crank it up a bit. And then you can see if I move this max value around, I can see different values. So it looks rather extreme at a level of say one. So I can actually need to bring it down a bit because like I said before, we have this base level terrain height that is currently have it at 0.2. So the range is zero to one, have it at point two, so here I need to really keep the max value around 0.8 to ensure that I'm not clipping. Now these values that I'm going to be using are actually going to serve as a probability of being in a particular biome, which we'll see in a second here. So I've got this noise defined. Then what I'm going to do is make a new node under and I can call this, the mountain biome. [NOISE] So I've renamed it and it's definitely very useful to rename. This has got some noise here, so you can see it's currently adding with this default value, so I'm muting it. We actually don't want to generate any noise. What we're going to do here, is to set that to none and I'll just crank this down for now to the max value of zero. So right now it's adding nothing. So here is where we're going to process the parents. So as I said before, this biomes node that we made with Perlin noise, that's really going to tell us the likelihood we're in a particular biome and I'm going to use the trapezoid function. And so there's two types of ways you can remap values. So there's the trapezoid function and there's a mapping curve. The trapezoid function is I think, much quicker to work with once you understand how it works. The mapping curve gives better results, but it's slower to process and it's tedious to edit. So what I often do is I quickly rough things out with a trapezoid function and then I will often later go in and replace the trapezoid function with a mapping curve that has much smoother transitions between areas. So I'm going to set this. In order to use the trapezoid function we have to have process parent variables. And so I had in mind that there might be lots of different types of parent processing. So there's these parent process variables, array. So the trapezoid function takes four values, so we'll set the array to four. Now you only set the x values for the trapezoid function in terms of mapping. There are assumed values for y. So element zero is, >> Anything to the left of this x-value would be 0. And then at that value, the y-value is 0. And then above that, it linearly interpolates between the element 0 x-value, and the element 1 x-value. The element 1 will map to a value of 1, so the y-value of 1. So you have no control directly over what to y-values, these x-values correspond to as predefined for you. So element 0 corresponds to a y-value of 0. Element 1 corresponds to a y-value of 1, element 2, y-value of 1, and element 3, y-value of 0. So you basically are creating a trapezoidal shape that ramps up from 0-1, has a plateau at 1, and then ramps back down from 1-0. So we can use that to specify where our mountains are going to be. So again, the biomes is like probability map. And then we're using that probability map to pick a subset of it with the mapping function, and that's where our mountains are going to be. So I'm going to say that we're going to stay 0 up until, I'll just pick something for now. Let's see. I'll go with 0.5. Everything below 0.5 is mapped to 0. And then from 0.5-0.6 is going to map to 1. And then we'll say, we'll go all the way to 1. So we're ramping up from 0.5-0.6 and then have a plateau. And so you can actually see the effect here. This is showing where our mountains will be. And actually, I'm going to set this to multiply. We can see visualize where these mountains are. So that just lets me see where the mountains are. But actually, I'm going to pull this max-value down to 0. Underneath this mountains biome node, I'm going to add a new child node. I'm going to name this mountain base. And I'm going to get some noise. Pretty low frequency. I think I just want this to add. So I've got at least something roughed out that looks like mountains. You can tell there's a bit of awkward shape. Because of the trapezoid, you can see looks like a tooth more than a mountain, but we can fix that later by smoothing things out, by switching to a curve rather than the trapezoidal shape. Then I could say add another node, call this mountain detail. Some higher frequency. And I can go back to the mountain biome and play around. See I can spread out or I can lower the slope of the trapezoid. And you can see right away gives a better result here. And I might want to bring my base down a little bit. That works pretty well. So that gives me at least a starting point for some mountains. And I might even just stick with the trapezoid function. If you're satisfied with it, you could just leave it as is. So then what I'm going to do is make a new biome. So as you recall, this one ramps up from 0, starting at 0.45, up to the plateaus of the trapezoid is at 0.6, and then it continues on and it just has a vertical slope at the end. So I'm going to make a new child node under the biomes. As you recall, biomes is giving me the source probabilities and leveraging and I'll call this Hills Biome. And I don't need any noise. I want to apply a trapezoid function, and I'm going to multiply, set the max-value to 1. For now just for visualization, I'm going to make 4 variables. And I'm going to go the other way. So what was this again, 4, 5-6? Let's go to see. >> What I've done is I've used the other half of the range or the other side of the range of values. And so right now I've got the max value set at one. And that just helps me to visualize, well, where are the hills going to be? I'm going to crank that back down to zero again here in a second, but it looks like it's something I can work with and I'll certainly have to do a lot of tweaking to get things just right. It's often tricky to get the transitions to look good. But I have something I can work with at least. I'm going to add a child node to the HillsBiome. Call this HillsBase. [NOISE] And give it a little bit of the Perlin noise here. Bring it down a little bit. That's looking pretty good. You'll notice you can clearly see the effect of the trapezoid function with this odd scalloped look here. Again, that is something we can get rid of. But we can work so much more quickly by defining our mapping with the trapezoid at first and then I'll show you the curve editing in a second. So that gives us some hills. We might go and play with the particular mapping here. So zero, zero. That means we basically have a vertical slope on the left side of the trapezoid, working our way up in values. And then at 0.3, it ramps down from the plateau all the way to zero, by the time you get to the value 0.5 and it stays zero from then on. So I could try playing around with these values. See, I'm starting to overlap into the hill area. If I go from 0.5-0.55 because I knew that ramps over so you get this influence. So like a mixture of the two biomes together. If you do that and if I want a steeper slope, I could say drop from 0.3-0.25. You can see here is more gradual, in that case. So I still have that weird little scalloped area, but already it looks a little better doing that. And I think next I will show adding some features. Let me add a little bit of a hill detail here. I'm going to add another child node. We'll call this hill detail. And this we'll use Perlin noise to add in. But I only want a little, it looks a little bit too stoned-like, let's see if I can make it look more like soil, I think that'll work. Let's see if I can think what's the best place to add? Guess I'll see if I can add it to the HillBase. I'm going to add a child here. Bring that down for now. I'll try to make some little stone type shapes. Let's name the stones. Now here's the tricky thing. If you want to make stones. Let's see. I think I do need the stones under hill details. So the problem is when a node has children like HillBase has hill detail and stones. The issue that I'm having here is that hills detail is adding to hills. And so stones is also adding to hills and so it's actually doubling the size of the hills because these two get added, but they already have the contribution of hills. Let's say I might be able to zero out, not here, in stones, I might built zero out the parent. Let's see if that works. I don't think that's going to do what I want here. Let's see if I can still add. Maybe I can go this route. So I've zeroed out the parents so I don't double the parent because hills detail's already doing that. So let's see if I can continue with this. So if I want to make stones, well, I probably want the stone pretty small, so you'd expect, well, a turn up the Perlin scalar a lot. And then I would just play with this. And while this looks like stony, but they're everywhere, I want them isolated like stones occasionally in the terrain. And this isn't getting it done. So I actually would probably like to have the stones appear. Say maybe about as often as these peaks that you see here. Maybe I would like there to be stones there, but you can see there's this big gradient buildup. It looks like I just have more mountains. So mountains with mountains instead of the nice little stones. That would be ideal. So what I can do is I can use a curve. So I'm going to switch the Perlin noise with mapping curve. And then I'm going to select the tool to control the gen noise curve. Click that. It's popped up on my other screen. So I can manipulate this curve right now it's just mapping one-to-one. So this effectively has no effect on it currently, see I can play around with this and get different shapes. So I could add different keys. And the keys I'm getting with the right-click. Then I can play with the normals. So you can see I'm already getting some interesting shapes here. Let's see I'll just jump to this curve which is little closer and you can bookmark previous curves you made, which is helpful. So let's see if I can manage to get something. So really, what I'm trying to do here is I want to ignore any Perlin noise below a certain threshold. >> Looking at the map behind the curve editing I'm doing, you can see I've got some stalactite looking things. I can play with this with enough time, which you probably don't want to watch me spend too much time on that. But the idea is I want to just isolate the highest values in my generated noise and that's going to be my stone shapes. Then I want them to be smaller, I can do so. And I can get fancier in this curve if I wanted to say, see, want to add like a little weird blip around. If you want to get like a depression, you can do some interesting things. Get a little like a sunken area around, make it a little deeper. I'm bringing up to a base level. We've got that sunken area. See it here in the map. This is a little stone and then like some type of erosion around where they are. I could actually maybe do subtract instead. Now I've got these cool-looking pockmarks on the terrain. Of course, you can do all sorts of function shapes to get interesting effects that you might like, and you can see how they're now spread out nicely. Which is a trick you can do, is kind of way that you can place features periodically. You'll notice that these features, because they're under the hills biome, they're only on the hills and not on the mountains. If I go to the terrain here, which is the root level node, I can now slide around. And you can see what everything looks like far away from where we started. You can see it repeats. Just goes on and on. It takes a good bit of effort to get the tiling. But yeah, there's lots of places that say your game player could explore. But this should give you an idea of how you can tackle this task of designing rules that have these different areas. And so you can do similar things. You can make canyons or just by using the mapping function. Say, if you make a biome, you can identify a range to be canyons and then you can choose to do add or subtract and some of the other combinations. You can make say features that are just like at the top of your mountains. There's a lot you can do to create terrain. But hopefully having seen these functions that will help you out, I guess one thing I didn't show it was switching from a trapezoid function to a curve. We still have a slight bit of an artifact in the hills. Maybe I'll share that real quick. So as you recall, the hills biome it's got this trapezoid function. It's all flat up to 0.25 but that's a value of one. So the hill is fully engaged from 0 up to 0.25 and then it ramps down to 0.5. So I could try to make that shape. Go and switch to a mapping curve. It's going to suddenly change. It's going to go process parent curve. I know that needs to be at one. You can just write, maybe and make this flat. This one is going to be 0, see if I can remember how, I'll just zoom it equally here. I can't see my coordinates. I'll just guess, get it right then make that flat. I forgot my values already. I got to go to 0.25. I add a key here, 0.25 to this in the wrong place. And you know, break this. So that can control separately. Then go to 0.5. Another key. So this roughed it out, but you can see that it is smoother now and I really should spend a little more time on it if I was trying to refine it. But just for this video, I'll end that there. But you can see it is a little tedious to edit the curve. But you can see now that the hills look a little better. It doesn't have that artifact from the linear interpolation of the trapezoid. Now with a non-linear curve, it looks a little better. I could do the same thing with the mountains. Probably could make this nicer. Some other things I could look to try are make more overlap in these transitions, have a more graceful or gradual change in the transition, which I didn't bother with here, just to make things distinct for the example. Hopefully that shows you enough to begin to understand the tool and how to define your rules to create your own procedurally generated terrain.
